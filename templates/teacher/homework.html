<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <title>–î–æ–º–∞—à–Ω—ñ –∑–∞–≤–¥–∞–Ω–Ω—è | ShoPoDz</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/homework.css') }}">
</head>
<body>
<div class="homework-container">
    <div class="hw-header">
        <button id="prev-week" onclick="changeWeek(-7)">‚Üê –ü–æ–ø–µ—Ä–µ–¥–Ω—ñ–π —Ç–∏–∂–¥–µ–Ω—å</button>
        <span id="week-range">{{ week_start }} ‚Äî {{ week_end }}</span>
        <button id="next-week" onclick="changeWeek(7)">–ù–∞—Å—Ç—É–ø–Ω–∏–π —Ç–∏–∂–¥–µ–Ω—å ‚Üí</button>
    </div>
    {% for day_data in homework_data %}
        <h4 style="margin: 16px 0 6px 0;">
            {{ day_data.date.strftime('%A, %d.%m') }}
        </h4>
        <table class="hw-table">
            <tr>
                <th>–ö–ª–∞—Å</th>
                <th>–£—Ä–æ–∫</th>
                <th>–î–æ–º–∞—à–Ω—î –∑–∞–≤–¥–∞–Ω–Ω—è</th>
                <th>–î—ñ—ó</th>
            </tr>
            {% for item in day_data.lessons %}
            <tr>
                <td>
                    {{ item.lesson.class_id }}
                    <!-- –Ø–∫—â–æ –ø–æ—Ç—Ä—ñ–±–Ω–æ ‚Äî –≤–∏–≤–µ–¥–∏ –Ω–∞–∑–≤—É –∫–ª–∞—Å—É —á–µ—Ä–µ–∑ –∑–≤ º—è–∑–æ–∫ lesson.class_.class_number —ñ subclass -->
                </td>
                <td>
                    {% if item.lesson.subject_id %}
                        {{ item.lesson.subject_id }}
                        <!-- –ê–Ω–∞–ª–æ–≥—ñ—á–Ω–æ ‚Äî —è–∫—â–æ —î lesson.subject.title, –≤–∏–≤–æ–¥—å –π–æ–≥–æ -->
                    {% else %}
                        ‚Äî
                    {% endif %}
                </td>
                <td>
                    {% if item.homework %}
                        {{ item.homework.description }}
                    {% else %}
                        <span class="hw-empty">-</span>
                    {% endif %}
                </td>
                <td>
                    {% if item.date >= current_date %}
                        {% if item.homework %}
                            <button class="edit-btn" data-id="{{ item.homework.homework_id }}">‚úé</button>
                            <button class="delete-btn" data-id="{{ item.homework.homework_id }}">üóë</button>
                        {% else %}
                            <button class="edit-btn" data-lesson="{{ item.lesson.lesson_id }}">–î–æ–¥–∞—Ç–∏</button>
                        {% endif %}
                    {% else %}
                        <span class="disabled">‚Äî</span>
                    {% endif %}
                </td>
            </tr>
            {% endfor %}
        </table>
    {% endfor %}
</div>
<script>
function changeWeek(deltaDays) {
    const url = new URL(window.location.href);
    let start = "{{ week_start }}";
    let newStart = new Date(start);
    newStart.setDate(newStart.getDate() + deltaDays);
    let iso = newStart.toISOString().slice(0, 10);
    url.searchParams.set('week_start', iso);
    window.location.href = url.toString();
}
</script>
<script src="{{ url_for('static', filename='js/homework.js') }}"></script>
</body>
</html>
